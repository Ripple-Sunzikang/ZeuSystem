# RISC-V CPU 流水线各阶段仿真报告

## 概述

本文档记录了 miniRV CPU 五个模块的仿真测试结果及波形分析。

## 1. Controller 控制器模块

### 1.1 模块功能
控制器根据指令的 opcode、funct3、funct7 字段生成控制信号。

### 1.2 仿真结果

| 指令类型 | npc_op | rf_we | rf_wsel | alu_op | ram_we | sext_op |
|---------|--------|-------|---------|--------|--------|---------|
| R-ADD   | 000    | 1     | 000     | 000    | 0      | 000     |
| R-SUB   | 000    | 1     | 000     | 001    | 0      | 000     |
| I-ADDI  | 000    | 1     | 000     | 000    | 0      | 000     |
| I-LW    | 000    | 1     | 001     | 000    | 0      | 000     |
| S-SW    | 000    | 0     | 000     | 000    | 1      | 001     |
| B-BEQ   | 001    | 0     | 000     | 001    | 0      | 010     |
| U-LUI   | 000    | 1     | 011     | 001    | 0      | 011     |
| J-JAL   | 010    | 1     | 010     | 001    | 0      | 100     |

### 1.3 波形说明
- **opcode**: 指令操作码，决定指令类型
- **npc_op**: 下一PC选择 (000=PC+4, 001=BEQ, 010=JAL, 110=JALR)
- **rf_we**: 寄存器写使能，SW/B型指令为0
- **rf_wsel**: 写回数据选择 (000=ALU, 001=MEM, 010=PC+4, 011=SEXT)
- **alu_op**: ALU操作码
- **ram_we**: 存储器写使能，仅SW指令为1

![Controller波形](controller_wave.svg)

---
